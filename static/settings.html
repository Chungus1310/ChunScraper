<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChunScraper - Settings</title>
    <style>
        :root {
            --gantry-1: #F2F2F2;
            --gantry-2: #A5A5A5;
            --gantry-3: #404040;
            --gantry-4: #262626;
            --gantry-5: #0D0D0D;
            --accent: #404040;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.5;
            color: var(--gantry-4);
            background: var(--gantry-1);
            min-height: 100vh;
            overflow-x: hidden;
        }

        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        .app-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .background-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.02;
            pointer-events: none;
            background-image: 
                linear-gradient(var(--gantry-4) 1px, transparent 1px),
                linear-gradient(90deg, var(--gantry-4) 1px, transparent 1px);
            background-size: 50px 50px;
            z-index: -1;
        }

        .header {
            padding: 2rem 2rem 1rem;
            text-align: center;
            position: relative;
            animation: slideDown 0.8s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .brand {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .logo {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--gantry-4) 0%, var(--gantry-5) 100%);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 4px 20px -4px rgba(13, 13, 13, 0.25);
            overflow: hidden;
        }

        .logo-icon {
            width: 24px;
            height: 24px;
            position: relative;
            z-index: 2;
        }

        .logo-icon::before,
        .logo-icon::after {
            content: '';
            position: absolute;
            background: var(--gantry-1);
            border-radius: 2px;
        }

        .logo-icon::before {
            width: 20px;
            height: 3px;
            top: 6px;
            left: 2px;
        }

        .logo-icon::after {
            width: 16px;
            height: 3px;
            bottom: 6px;
            right: 2px;
        }

        .brand h1 {
            font-size: 2.25rem;
            font-weight: 700;
            color: var(--gantry-5);
            letter-spacing: -0.025em;
        }

        .main-content {
            flex: 1;
            display: flex;
            justify-content: center;
            padding: 0 2rem 4rem;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 32px;
            padding: 3rem;
            width: 100%;
            max-width: 640px;
            box-shadow: 
                0 20px 50px -12px rgba(13, 13, 13, 0.08),
                0 8px 16px -8px rgba(13, 13, 13, 0.02),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(165, 165, 165, 0.12);
            position: relative;
            animation: slideUp 0.8s cubic-bezier(0.16, 1, 0.3, 1);
            animation-delay: 0.2s;
            animation-fill-mode: backwards;
            overflow: hidden;
        }

        .form-section {
            margin-bottom: 2rem;
        }

        .input-group {
            margin-bottom: 1.5rem;
        }

        .input-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--gantry-4);
            font-size: 0.875rem;
            letter-spacing: 0.025em;
            text-transform: uppercase;
        }

        .input-field, .select-field {
            width: 100%;
            padding: 1.125rem 1.5rem;
            border: 2px solid rgba(165, 165, 165, 0.15);
            border-radius: 20px;
            font-size: 16px;
            font-family: inherit;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(242, 242, 242, 0.4);
            color: var(--gantry-4);
        }

        .input-field:focus, .select-field:focus {
            outline: none;
            border-color: var(--gantry-3);
            background: rgba(255, 255, 255, 0.9);
            transform: translateY(-2px) scale(1.01);
            box-shadow: 
                0 20px 40px -12px rgba(64, 64, 64, 0.15),
                0 0 0 4px rgba(64, 64, 64, 0.05);
        }

        .api-key-list {
            list-style: none;
            margin-top: 0.5rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .api-key-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(242, 242, 242, 0.6);
            padding: 0.5rem 1rem;
            border-radius: 12px;
        }

        .api-key-item span {
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-family: 'SF Mono', 'Monaco', monospace;
        }

        .remove-key-btn {
            background: none;
            border: none;
            color: var(--error);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0.25rem;
        }

        .add-key-container {
            display: flex;
            gap: 0.5rem;
        }

        #newApiKey { flex: 1; }

        .add-key-btn {
            padding: 0 1.5rem;
            background: var(--gantry-3);
            color: white;
            border: none;
            border-radius: 20px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s;
        }
        .add-key-btn:hover { background: var(--gantry-4); }

        .submit-button {
            width: 100%;
            padding: 1.25rem 2rem;
            background: linear-gradient(135deg, var(--gantry-4) 0%, var(--gantry-5) 100%);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 1.05rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .submit-button:hover {
            transform: translateY(-3px) scale(1.02);
        }

        .status-card {
            margin-top: 2rem;
            border-radius: 20px;
            padding: 1.5rem;
            display: none;
            animation: slideIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .status-card.show { display: block; }
        .status-success {
            background: rgba(16, 185, 129, 0.08);
            border: 1px solid rgba(16, 185, 129, 0.2);
            color: var(--gantry-4);
        }
        .status-message { font-weight: 500; }

        .back-link {
            display: inline-block;
            margin-top: 2rem;
            color: var(--gantry-3);
            text-decoration: none;
            font-weight: 500;
        }
        .back-link:hover { text-decoration: underline; }

        @keyframes slideDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px) scale(0.95); } to { opacity: 1; transform: translateY(0) scale(1); } }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="background-grid"></div>
        
        <header class="header">
            <div class="brand">
                <a href="/" class="logo">
                    <div class="logo-icon"></div>
                </a>
                <h1>ChunScraper - Settings</h1>
            </div>
        </header>

        <main class="main-content">
            <div class="card">
                <form id="settingsForm" class="form-section">
                    <div class="input-group">
                        <label class="input-label">Gemini API Keys</label>
                        <p style="font-size: 0.9rem; color: var(--gantry-2); margin-bottom: 1rem;">
                            Add one or more API keys. The system will automatically rotate to the next key if one fails. Keys are stored locally in your browser.
                        </p>
                        <div id="apiKeyList" class="api-key-list"></div>
                        <div class="add-key-container">
                            <input type="password" id="newApiKey" class="input-field" placeholder="Enter new API Key">
                            <button type="button" id="addApiKeyBtn" class="add-key-btn">Add</button>
                        </div>
                    </div>

                    <div class="input-group">
                        <label for="model" class="input-label">AI Model</label>
                        <select id="model" name="model" class="select-field">
                            <option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
                            <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                            <option value="gemini-2.5-flash-lite">Gemini 2.5 Flash Lite</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="timeout" class="input-label">Request Timeout (seconds)</label>
                        <input type="number" id="timeout" name="timeout" class="input-field" min="1" max="300" value="60">
                    </div>

                    <button type="submit" class="submit-button">Save Settings</button>
                </form>

                <div id="statusCard" class="status-card">
                    <div id="statusMessage" class="status-message"></div>
                </div>

                <a href="/" class="back-link">&larr; Back to Scraper</a>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const settingsForm = document.getElementById('settingsForm');
            const apiKeyList = document.getElementById('apiKeyList');
            const newApiKeyInput = document.getElementById('newApiKey');
            const addApiKeyBtn = document.getElementById('addApiKeyBtn');
            const modelSelect = document.getElementById('model');
            const timeoutInput = document.getElementById('timeout');
            const statusCard = document.getElementById('statusCard');
            const statusMessage = document.getElementById('statusMessage');

            let apiKeys = [];

            function renderApiKeys() {
                apiKeyList.innerHTML = '';
                apiKeys.forEach((key, index) => {
                    const li = document.createElement('li');
                    li.className = 'api-key-item';
                    const maskedKey = key.length > 8 ? `${key.substring(0, 4)}...${key.substring(key.length - 4)}` : key;
                    li.innerHTML = `
                        <span>${maskedKey}</span>
                        <button type="button" class="remove-key-btn" data-index="${index}" title="Remove key">&times;</button>
                    `;
                    apiKeyList.appendChild(li);
                });

                document.querySelectorAll('.remove-key-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const index = parseInt(e.currentTarget.dataset.index, 10);
                        apiKeys.splice(index, 1);
                        renderApiKeys();
                    });
                });
            }

            function loadSettings() {
                const savedSettings = localStorage.getItem('chunScraperSettings');
                if (savedSettings) {
                    const settings = JSON.parse(savedSettings);
                    apiKeys = settings.apiKeys || [];
                    modelSelect.value = settings.model || 'gemini-2.5-flash';
                    timeoutInput.value = settings.timeout || 10;
                    renderApiKeys();
                }
            }

            function saveSettings() {
                const settings = {
                    apiKeys: apiKeys,
                    model: modelSelect.value,
                    timeout: parseInt(timeoutInput.value, 10)
                };
                localStorage.setItem('chunScraperSettings', JSON.stringify(settings));
                
                statusCard.className = 'status-card show status-success';
                statusMessage.textContent = 'Settings saved successfully!';
                setTimeout(() => {
                    statusCard.classList.remove('show');
                }, 3000);
            }

            addApiKeyBtn.addEventListener('click', () => {
                const newKey = newApiKeyInput.value.trim();
                if (newKey && !apiKeys.includes(newKey)) {
                    apiKeys.push(newKey);
                    newApiKeyInput.value = '';
                    renderApiKeys();
                }
            });

            settingsForm.addEventListener('submit', (e) => {
                e.preventDefault();
                saveSettings();
            });

            loadSettings();
        });
    </script>
</body>
</html>
